<!-- Titulo principal-->
<div class="header-admi1">
  <div class="header-text">
    <div class="containerstart" >
      <p > CUPONES</p>
    </div>
  </div>
  <svg preserveAspectRatio="xMidYMid">
    <path d="M0,60 L0,0 L1290,0 L1290,60" fill="#333539"  />
    <path d="M320,60 Q448,85 550,60" fill="#333539" />
  </svg>
</div>

<!-- FILTROS-->
<div class="container-fluid">
<div class="d-flex flex-wrap header-solicitud align-items-center gap-3">   
  <div class="containerstart1" >
    <label class="calendar-label">Desde:</label>
    <div class="date-container" >
      <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
      <mat-datepicker #picker1></mat-datepicker>
      <input matInput [matDatepicker]="picker1" placeholder="SELECCIONA DIA"
      [(ngModel)]="fechaInicio" (dateChange)="filtrarPorFechas()">
    </div>
  </div>
  
  <div class="containerstart2" >
    <label class="calendar-label">Hasta:</label>
    <div class="date-container" >
      <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
      <mat-datepicker #picker2></mat-datepicker>
      <input matInput [matDatepicker]="picker2" placeholder="SELECCIONA DIA"
      [(ngModel)]="fechaFin" (dateChange)="filtrarPorFechas()">
    </div>
  </div>

  <div class="containerstart3">
    <button class="search-button" id="basic-addon1">
      <i class="bi bi-search"></i>
    </button>
    <div class="date-container">
      <div class="input-group search-group">
        <input 
          type="text" 
          class="form-control search-input" 
          placeholder="BUSCAR"
          aria-label="Buscar" 
          aria-describedby="basic-addon1" 
          (input)="search($event)">
      </div> 
    </div>       
  </div>
</div>
<div class="d-flex flex-wrap header-admin justify-content-between">
  <button class="admin-button"
  type="button"
      data-bs-toggle="modal"
      href="#modalCrearPromocion"
  >
    <span class="material-icons">add_circle</span>
    AGREGAR CUPÓN
  </button>
  <div class="dropdown-container">
    <button class="dropdown-button" (click)="toggleDropdown()">
      <span class="material-icons">add_circle</span>
      AGREGAR PROVEEDORES
    </button>
  
    <div class="dropdown-options" *ngIf="dropdownOpen">
      <div *ngFor="let opcion of categoria " 
           
           class="dropdown-option">
        {{ opcion.nombre}}
      </div>
    </div>
  </div>
  
</div>


<!-- Inicio table info-->
  <div class="header-contenedor" >
    <div class="header">
      <span class="tabla-title1">IMAGEN</span>
      <span class="tabla-title">CODIGO</span>
      <span class="tabla-title">TITULO</span>
      <span class="tabla-title">CANTIDAD</span>
      <span class="tabla-title">FECHA INICIO</span>
      <span class="tabla-title">FECHA FIN</span>
      <span class="tabla-title">ESTADO</span>
    </div>
  </div>

  <div class="contenedor-categorias"  >
    <div 
    (click)="ver(a)"
      *ngFor="let a of arr_filtered_cupon"
      data-bs-toggle="modal"
      href="#modalInformacionProfesion"
      role="button"
      class="categoria" >
      <div class="item-imagen">
        <img
        [src]="
          a.foto
            ? 'https://tomesoft1.pythonanywhere.com' + a.foto
            : 'assets/imagenes/ProfesionDefault.png'
        "
        class="imagen"
        alt="..."
      />
      </div>
      <div class="item-nombre">{{ a.codigo }}</div>
      <div class="item-descripcion">{{ a.titulo }}</div>
      <div class="item-descripcion">{{ a.cantidad }}</div>
      <div class="item-descripcion">{{ a.fecha_iniciacion | date : "d/M/Y"}}</div>
      <div class="item-descripcion">{{ a.fecha_expiracion | date : "d/M/Y"}}</div>
      <div class="item-estado d-flex align-items-center">
        <span
              *ngIf="a.estado"
              class="estado-indicador bg-success me-2"
            ></span>
        <span *ngIf="a.estado" class="text-success">ACTIVO</span>
        <span
              *ngIf="!a.estado"
              class="estado-indicador bg-secondary me-2" 
            ></span>
            <span *ngIf="!a.estado" class="text-muted">Terminado</span>
      </div>
    </div>
  </div>
</div>

<!-- Fin table info-->

<!-------------------------------------------------------------------------------------------------------->
<div
class="modal fade"
id="modalCrearPromocion"
aria-hidden="true"
aria-labelledby="modalCrearProfesionLabel"
data-bs-backdrop="static"
data-bs-keyboard="false"
tabindex="-1"
>
<div class="modal-dialog modal-dialog-centered">
  <div class="modal-content">
    <div class="modal-header align-items-center">
      <h1
        class="modal-title fs-5 m-0 p-0 fw-bold"
        id="modalCrearProfesionLabel"
      >
        Crear Cupón
      </h1>
      
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-body mb-0">
      <form [formGroup]="cuponCrear" class="promC">
        <!-- Seccion de imagen -->
        <div class="cont-ped">
          <div class="form-field">
              <button class="admin-button1"
                  type="button"
                   (click)="abrirSelectorArchivo($event, fileInput)">
                                 
              <span class="material-icons">description</span> 
              SELECCIONAR ARCHIVO
              <span class="material-icons">add_circle</span> 
              </button>
          </div>
          <div class="form-field">
            <input #fileInput
              class="w-50 centrar form-control"
              [ngClass]="
                cuponCrear.get('imagen')?.hasError('image_error')
                  ? 'is-invalid'
                  : '' || existImageCrear
                  ? 'is-valid'
                  : ''
              "
              type="file"
              accept="image/png, image/jpeg"
              (click)="$event.stopPropagation()"
              (change)="loadImageFromDevice($event, 'crear')"
              style="display: none;"
            >
            <img
              *ngIf="existImageCrear"
              class="rounded mx-auto d-block img-fluid custom-width image_modal"
              [src]="imagenCrear"
              alt="Archivo
              incorrecto"
            />           
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "imagen") }}
              </div>
          </div>
        </div>

        <div class="cont-ped">
          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Codigo:</h3></label
              >
            </div>
            <div class="col-7">
              <input
                type="text"
                formControlName="codigo"
                class="form-control"
                [ngClass]="
                  isInvalidForm('codigo', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('codigo')?.touched ||
                      (cuponCrear.get('codigo')?.dirty &&
                        !cuponCrear.get('codigo')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                placeholder="Codigo"
              />
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "codigo") }}
              </div>
            </div>
          </div>
          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Titulo:</h3></label
              >
            </div>
            <div class="col-5">
              <input
                type="text"
                formControlName="titulo"
                class="form-control"
                [ngClass]="
                  isInvalidForm('titulo', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('titulo')?.touched ||
                      (cuponCrear.get('titulo')?.dirty &&
                        !cuponCrear.get('titulo')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                placeholder="Titulo promocion"
              />
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "titulo") }}
              </div>
            </div>
          </div>           
        </div>

        
        <div class="row pp">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Descripcion:</h3></label
            >
          </div>
          <div class="col-7">
            <textarea
              type="text"
              formControlName="descripcion"
              class="form-control"
              [ngClass]="
                isInvalidForm('descripcion', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('descripcion')?.touched ||
                    (cuponCrear.get('descripcion')?.dirty &&
                      !cuponCrear.get('descripcion')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              placeholder="Descripcion"
            ></textarea>
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "descripcion") }}
            </div>
          </div>
        </div>

        <div class="cont-ped">
          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Descuento:</h3></label
              >
            </div>
            <div class="col-7">
              <input
                type="text"
                formControlName="descuento"
                class="form-control"
                [ngClass]="
                  isInvalidForm('descuento', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('descuento')?.touched ||
                      (cuponCrear.get('descuento')?.dirty &&
                        !cuponCrear.get('descuento')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                placeholder="%"
              />
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "descuento") }}
              </div>
            </div>
          </div>  


          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Cantidad:</h3></label
              >
            </div>
            <div class="col-7">
              <input
                type="text"
                formControlName="cantidad"
                class="form-control"
                [ngClass]="
                  isInvalidForm('cantidad', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('cantidad')?.touched ||
                      (cuponCrear.get('cantidad')?.dirty &&
                        !cuponCrear.get('cantidad')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                placeholder=""
              />
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "cantidad") }}
              </div>
            </div>
          </div>  
              
        </div>

        <div class="cont-ped">
          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Participantes:</h3></label
              >
            </div>
            <div class="col-7">
              <select
                class="form-select"
                [ngClass]="
                  isInvalidForm('participantes', 'crear') ? 'is-invalid' : ''
                "
                formControlName="participantes"
                class="form-control"
                [ngClass]="
                  isInvalidForm('participantes', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('participantes')?.touched ||
                      (cuponCrear.get('participantes')?.dirty &&
                        !cuponCrear.get('participantes')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                aria-describedby="selectorServicioCrearFeedback"
              >
                <option selected disabled value="">
                  Elija participante...
                </option>
                <option *ngFor="let c of participante" [id]="c" [value]="c">
                  {{ c }}
                </option>
              </select>
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "participantes") }}
              </div>
            </div>
          </div> 

          <div class="form-field">
            <div class="col-5">
              <label for="selectorServicioCrear" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Categoria:</h3></label
              >
            </div>
            <div class="col-7">
              <select
                class="form-select"
                [ngClass]="
                  isInvalidForm('categoria', 'crear') ? 'is-invalid' : ''
                "
                formControlName="categoria"
                class="form-control"
                [ngClass]="
                  isInvalidForm('categoria', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('categoria')?.touched ||
                      (cuponCrear.get('categoria')?.dirty &&
                        !cuponCrear.get('categoria')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                aria-describedby="selectorServicioCrearFeedback"
              >
                <option selected disabled value="">
                  Elija una Categoria...
                </option>
                <option
                  *ngFor="let c of categoria"
                  [id]="c.nombre"
                  [value]="c.nombre"
                >
                  {{ c.nombre }}
                </option>
              </select>
              <div id="selectorServicioCrearFeedback" class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "categoria") }}
              </div>
            </div>
          </div> 
        </div>
        

        <div class="cont-ped">
          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Fecha Inicio:</h3>
              </label>
            </div>
            <div class="col-7">
            <input
              type="date"
              id="start"
              formControlName="inicio"
              [ngClass]="
                isInvalidForm('inicio', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('inicio')?.touched ||
                    (cuponCrear.get('inicio')?.dirty &&
                      !cuponCrear.get('inicio')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              required
              pattern="\d{4}-\d{2}-\d{2}"
              min="{{ getCurrentDate() }}"
            />
            </div>
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "inicio") }}
            </div>
        </div>


          <div class="form-field">
            <div class="col-5">
              <label for="inputNombre" class="form-label"
                ><h3 class="m-0 p-0 fw-bold">Fecha Expiracion:</h3>
              </label>
            </div>
            <div class="col-7">
              <input
                class="inputCrear"
                formControlName="fin"
                type="date"
                id="start"
                required
                [ngClass]="
                  isInvalidForm('fin', 'crear')
                    ? 'is-invalid'
                    : cuponCrear.get('fin')?.touched ||
                      (cuponCrear.get('fin')?.dirty &&
                        !cuponCrear.get('fin')?.invalid)
                    ? 'is-valid'
                    : ''
                "
                min="{{ getCurrentDate() }}"
              />
              <div class="invalid-feedback">
                {{ getErrorMessage(cuponCrear, "fin") }}
              </div>
            </div>
          </div>
        </div>

      </form>
    </div>
    <div class="modal-footer">
      <button
        [disabled]="cuponCrear.invalid ? true : false"
        data-bs-target="#modalConfirmacion"
        data-bs-toggle="modal"
        class="custom-button3"
        (click)="
          establecerMensaje(
            'Está seguro que desea crear el cupon?',
            'crear'
          )
        "
      >
        Crear
      </button>
    </div>

  </div>
</div>
</div>

<!-------------------------------------------------------------------------------------------------------->
<div
class="modal fade"
id="modalInformacionProfesion"
aria-hidden="true"
aria-labelledby="modalInformacionProfesionLabel"
tabindex="-1"
>
<div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
  <div class="modal-content">
    <div class="modal-header align-items-center">
      <h1
        class="modal-title fs-5 m-0 p-0 fw-bold"
        id="modalInformacionProfesionLabel"
      >
        Información de cupones
      </h1>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-body mb-0">
      <div class="row p-2">
        <div class="row p-2">
          <img
            [src]="
              cupon_seleccionada?.foto
                ? 'https://tomesoft1.pythonanywhere.com' + cupon_seleccionada?.foto
                : 'assets/imagenes/ProfesionDefault.png'
            "
            class="rounded mx-auto d-block img-fluid w-50 image_modal"
            alt="..."
          />
        </div>
      </div>

      <div class="row p-2 align-items-center">
        <div class="col-5">
          <h3 class="m-0 p-0 fw-bold">Titulo:</h3>
        </div>
        <div class="col-7">
          {{ cupon_seleccionada?.titulo }}
        </div>
      </div>

      <div class="row p-2 align-items-center">
        <div class="col-5">
          <h3 class="m-0 p-0 fw-bold">Codigo:</h3>
        </div>
        <div class="col-7">
          {{ cupon_seleccionada?.codigo }}
        </div>
      </div>

      <div class="row p-2 align-items-center">
        <div class="col-5">
          <h3 class="m-0 p-0 fw-bold">Descuento:</h3>
        </div>
        <div class="col-7">
          {{ cupon_seleccionada?.porcentaje }}
        </div>
      </div>

      <div class="row p-2 align-items-center">
        <div class="col-5">
          <h3 class="m-0 p-0 fw-bold">Cantidad</h3>
        </div>
        <div class="col-7">
          {{ cupon_seleccionada?.cantidad }}
        </div>
      </div>

      <div class="row p-2 align-items-center">
        <div class="col-5">
          <h3 class="m-0 p-0 fw-bold">Fecha inicio</h3>
        </div>
        <div class="col-7">
          {{
            cupon_seleccionada?.fecha_iniciacion
              | date : " MMM d, y, h:mm:ss a"
          }}
        </div>
      </div>

      <div class="row p-2 align-items-center">
        <div class="col-5">
          <h3 class="m-0 p-0 fw-bold">Fecha de Expiracion</h3>
        </div>
        <div class="col-7">
          {{
            cupon_seleccionada?.fecha_iniciacion
              | date : " MMM d, y, h:mm:ss a"
          }}
        </div>
      </div>

     <div class="row p-2 align-items-center">
        <div class="col-5">
          <label for="switchEstado" class="form-check-label"
            ><h3 class="m-0 p-0 fw-bold">Habilitar/Deshabilitar:</h3></label
          >
        </div>
        <div
          class="col-7 form-check form-switch d-flex justify-content-end fs-6"
        >
          <input
            (change)="cambiarEstado($event)"
            [checked]="cupon_seleccionada?.estado ? true : false"
            class="form-check-input"
            id="switchEstado"
            type="checkbox"
            role="switch"
            checked
            aria-describedby="switchEstadoFeedback"
          />
        </div>
      </div> 
    </div>
    <div class="modal-footer">
      <button
        class="btn btn-danger"
        data-bs-target="#modalConfirmacion"
        data-bs-toggle="modal"
        (click)="
          establecerMensaje(
            'Está seguro que desea eliminar el cupon?',
            'eliminar'
          )
        "
      >
        Eliminar
      </button>
      <button
        (click)="limpiarForm('actualizar')"
        class="btn btn-success"
        data-bs-target="#modalInformacionEdicionProfesion"
        data-bs-toggle="modal"
      >
        Editar
      </button>
    </div>
  </div>
</div>
</div>

<div
class="modal fade"
id="modalInformacionEdicionProfesion"
aria-hidden="true"
aria-labelledby="modalInformacionEdicionProfesionLabel"
tabindex="-1"
>
<div class="modal-dialog modal-dialog-centered">
  <div class="modal-content">
    <div class="modal-header align-items-center">
      <h1
        class="modal-title fs-5 m-0 p-0 fw-bold"
        id="modalInformacionEdicionProfesionLabel"
      >
        Edición de Cupones
      </h1>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-body mb-0">
      <form [formGroup]="cuponCrear" class="">
        <div class="row">
          <div class="col d-flex justify-content-center">
            <img
              *ngIf="existImageActualizar"
              class="image_modal rounded mx-auto d-block img-fluid w-50"
              [src]="imagenActualizar"
              alt="Archivo incorrecto"
            />
            <img
              *ngIf="!existImageActualizar && cupon_seleccionada?.foto"
              class="image_modal rounded mx-auto d-block img-fluid w-50"
              [src]="'https://tomesoft1.pythonanywhere.com' + cupon_seleccionada?.foto"
              alt="Archivo incorrecto"
            />
            <i
              *ngIf="!existImageActualizar && !cupon_seleccionada?.foto"
              class="rounded mx-auto d-block img-fluid w-50 bi bi-upload icono"
            ></i>
          </div>
          <div class="p-2">
            <input
              class="w-100 centrar form-control"
              [ngClass]="
                cuponCrear.get('imagen')?.hasError('image_error')
                  ? 'is-invalid'
                  : '' || existImageActualizar
                  ? 'is-valid'
                  : ''
              "
              type="file"
              id="file_input"
              accept="image/png, image/jpeg"
              (change)="loadImageFromDevice($event, 'actualizar')"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "imagen") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Titulo:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="titulo"
              class="form-control"
              [ngClass]="
                isInvalidForm('titulo', 'actualizar') ? 'is-invalid' : ''
              "
              value="Mark"
              [placeholder]="cupon_seleccionada?.titulo"
              [value]="cupon_seleccionada?.titulo"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "titulo") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Descripcion:</h3></label
            >
          </div>
          <div class="col-7">
            <textarea
              type="text"
              formControlName="descripcion"
              class="form-control"
              [ngClass]="
                isInvalidForm('descripcion', 'actualizar') ? 'is-invalid' : ''
              "
              [value]="cupon_seleccionada?.descripcion"
            ></textarea>
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "descripcion") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Descuento:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="descuento"
              class="form-control"
              [ngClass]="
                isInvalidForm('descuento', 'actualizar') ? 'is-invalid' : ''
              "
              [value]="cupon_seleccionada?.porcentaje"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "descuento") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Cantidad:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="cantidad"
              class="form-control"
              [ngClass]="
                isInvalidForm('cantidad', 'actualizar') ? 'is-invalid' : ''
              "
              [value]="cupon_seleccionada?.cantidad"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "cantidad") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Fecha de Inicio:</h3></label
            >
          </div>
          <div class="col-7">
            <small>{{
              cupon_seleccionada?.fecha_iniciacion
                | date : " MMM d, y, h:mm:ss a"
            }}</small>
            <input
              type="date"
              [value]="cupon_seleccionada?.fecha_iniciacion"
              id="start"
              [ngClass]="
                isInvalidForm('inicio', 'actualizar') ? 'is-invalid' : ''
              "
              formControlName="inicio"
              min="{{ getCurrentDate() }}"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "inicio") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Fecha Expiracion:</h3>
            </label>
          </div>
          <div class="col-7">
            <small>{{
              cupon_seleccionada?.fecha_expiracion
                | date : " MMM d, y, h:mm:ss a"
            }}</small>
            <input
              [value]="cupon_seleccionada?.fecha_expiracion"
              [ngClass]="
                isInvalidForm('fin', 'actualizar') ? 'is-invalid' : ''
              "
              formControlName="fin"
              type="date"
              id="start"
              required
              min="{{ getCurrentDate() }}"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "fin") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Puntos:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="punto"
              class="form-control"
              [ngClass]="
                isInvalidForm('punto', 'actualizar') ? 'is-invalid' : ''
              "
              [value]="cupon_seleccionada?.puntos"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "punto") }}
            </div>
          </div>
        </div>

      </form>
    </div>
    <div class="modal-footer">
      <button
        class="btn btn-danger"
        data-bs-target="#modalInformacionProfesion"
        data-bs-toggle="modal"
      >
        Regresar
      </button>
      <button
        [disabled]="cuponCrear.invalid ? true : false"
        data-bs-target="#modalConfirmacion"
        data-bs-toggle="modal"
        class="btn btn-success"
        (click)="
          establecerMensaje(
            'Está seguro que desea actualizar la información?',
            'actualizar'
          )
        "
      >
        Actualizar
      </button>
    </div>

  </div>
</div>
</div>
<!-- Modal crear admi 


<div
class="modal fade"
id="modalCrearProfesion"
aria-hidden="true"
aria-labelledby="modalCrearProfesionLabel"
tabindex="-1"
>
<div class="modal-dialog modal-dialog-centered">
  <div class="modal-content">
    <div class="modal-header align-items-center">
      <h1
        class="modal-title fs-5 m-0 p-0 fw-bold"
        id="modalCrearProfesionLabel"
      >
        Crear Cupon
      </h1>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>
    <div class="modal-body mb-0">
      <form [formGroup]="cuponCrear" class="">


        <div class="row">
          <div class="col d-flex justify-content-center">
            <img
              *ngIf="existImageCrear"
              class="rounded mx-auto d-block img-fluid w-50 image_modal"
              [src]="imagenCrear"
              alt="Archivo
              incorrecto"
            />
            <i
              *ngIf="!existImageCrear"
              class="rounded mx-auto d-block img-fluid w-50 bi bi-upload icono"
            ></i>
          </div>
          <div class="p-2">
            <input
              class="w-100 centrar form-control"
              [ngClass]="
                cuponCrear.get('imagen')?.hasError('image_error')
                  ? 'is-invalid'
                  : '' || existImageCrear
                  ? 'is-valid'
                  : ''
              "
              type="file"
              id="file_input"
              accept="image/png, image/jpeg"
              (change)="loadImageFromDevice($event, 'crear')"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "imagen") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Codigo:</h3></label
            >
          </div>
          <div class="col-7">
            <input
            id="codigo"
              type="text"
              [placeholder]="codigo"
              [value]="codigo"
              formControlName="codigo"
              class="form-control"
              [ngClass]="
                isInvalidForm('codigo', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('codigo')?.touched ||
                    (cuponCrear.get('codigo')?.dirty &&
                      !cuponCrear.get('codigo')?.invalid)
                  ? 'is-valid'
                  : ''
              "
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "codigo") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Titulo:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="titulo"
              class="form-control"
              [ngClass]="
                isInvalidForm('titulo', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('titulo')?.touched ||
                    (cuponCrear.get('titulo')?.dirty &&
                      !cuponCrear.get('titulo')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              placeholder="cupones"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "titulo") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Descripcion:</h3></label
            >
          </div>
          <div class="col-7">
            <textarea
              type="text"
              formControlName="descripcion"
              class="form-control"
              [ngClass]="
                isInvalidForm('descripcion', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('descripcion')?.touched ||
                    (cuponCrear.get('descripcion')?.dirty &&
                      !cuponCrear.get('descripcion')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              placeholder="descripcion"
            ></textarea>
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "descripcion") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Descuento(%):</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="descuento"
              class="form-control"
              [ngClass]="
                isInvalidForm('descuento', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('descuento')?.touched ||
                    (cuponCrear.get('descuento')?.dirty &&
                      !cuponCrear.get('descuento')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              placeholder="5"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "descuento") }}
            </div>
          </div>
        </div>
        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Cantidad:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="cantidad"
              class="form-control"
              [ngClass]="
                isInvalidForm('cantidad', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('cantidad')?.touched ||
                    (cuponCrear.get('cantidad')?.dirty &&
                      !cuponCrear.get('cantidad')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              placeholder="1"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "cantidad") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Puntos:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="text"
              formControlName="punto"
              class="form-control"
              [ngClass]="
                isInvalidForm('punto', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('punto')?.touched ||
                    (cuponCrear.get('punto')?.dirty &&
                      !cuponCrear.get('punto')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              placeholder="1"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "punto") }}
            </div>
          </div>
        </div>


        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Fecha de Inicio:</h3></label
            >
          </div>
          <div class="col-7">
            <input
              type="date"
              id="start"
              [ngClass]="
                isInvalidForm('inicio', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('inicio')?.touched ||
                    (cuponCrear.get('inicio')?.dirty &&
                      !cuponCrear.get('inicio')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              required
              pattern="\d{4}-\d{2}-\d{2}"
              formControlName="inicio"
              min="{{ getCurrentDate() }}"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "inicio") }}
            </div>
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <label for="inputNombre" class="form-label"
              ><h3 class="m-0 p-0 fw-bold">Fecha Expiracion:</h3>
            </label>
          </div>
          <div class="col-7">
            <input
              formControlName="fin"
              type="date"
              id="start"
              required
              pattern="\d{4}-\d{2}-\d{2}"
              [ngClass]="
                isInvalidForm('fin', 'crear')
                  ? 'is-invalid'
                  : cuponCrear.get('fin')?.touched ||
                    (cuponCrear.get('fin')?.dirty &&
                      !cuponCrear.get('fin')?.invalid)
                  ? 'is-valid'
                  : ''
              "
              min="{{ getCurrentDate() }}"
            />
            <div class="invalid-feedback">
              {{ getErrorMessage(cuponCrear, "fin") }}
            </div>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button
        [disabled]="cuponCrear.invalid ? true : false"
        data-bs-target="#modalConfirmacion"
        data-bs-toggle="modal"
        class="btn btn-success"
        (click)="
          establecerMensaje(
            'Está seguro que desea crear la  profesión?',
            'crear'
          )
        "
      >
        Crear
      </button>
    </div>

  </div>
</div>
</div>-->

<!-- Modal de confirmacion (Alerta) -->
<div
class="modal fade"
id="modalConfirmacion"
tabindex="-1"
aria-labelledby="modalConfirmacionLabel"
aria-hidden="true"
>
<div class="modal-dialog">
  <div class="modal-content">
    <!-- Titulo del modal confirmacion -->
    <div class="modal-header">
      <h1
        class="modal-title fs-5 m-0 p-0 fw-bold"
        id="modalConfirmacionLabel"
      >
        Confirmar selección
      </h1>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="modal"
        aria-label="Close"
      ></button>
    </div>

    <!-- Cuerpo del modal confirmacion -->
    <div class="modal-body">
      {{ mensajeAlerta }}
    </div>

    <!-- Footer del modal confirmacion -->
    <div class="modal-footer">
      <button type="button" class="btn btn-danger" data-bs-dismiss="modal">
        Cancelar
      </button>
      <button
        *ngIf="isCrear"
        type="button"
        class="btn btn-success"
        (click)="onCrear()"
        data-bs-dismiss="modal"
      >
        Confirmar
      </button>
      <button
        *ngIf="isActualizar"
        type="button"
        class="btn btn-success"
        (click)="onActualizar()"
        data-bs-dismiss="modal"
      >
        Confirmar
      </button>
      <button
        *ngIf="isEliminar"
        type="button"
        class="btn btn-success"
        (click)="onDelete()"
        data-bs-dismiss="modal"
      >
        Confirmar
      </button>
    </div>
  </div>
</div>
</div>

<!-- Toast de Información -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
<div
  #liveToast
  id="liveToast"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
>
  <div
    class="toast-header"
    [ngClass]="
      isErrorToast
        ? ' bg-danger'
        : '
    bg-success'
    "
  >

    <strong class="me-auto text-light">{{ tituloToast }}</strong>
    <small class="text-light">Ahora</small>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div
    class="toast-body bg-opacity-25"
    [ngClass]="isErrorToast ? ' bg-danger' : ' bg-success'"
  >
    {{ mensajeToast }}
  </div>
</div>
</div>
